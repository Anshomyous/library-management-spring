<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:jdbc="http://www.springframework.org/schema/jdbc"
             xmlns="http://www.springframework.org/schema/security"
             xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
            http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.1.xsd
            http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd">

    <!-- enable use-expressions -->
    <http auto-config="true" use-expressions="true">

        <intercept-url pattern="/user/showall" access="hasRole('ROLE_LIBRARIAN')"/>

    </http>
    <jdbc:embedded-database id="dataSource"/>

    <!-- Select users and user_roles from database -->
    <authentication-manager>
        <authentication-provider>
            <jdbc-user-service data-source-ref="dataSource"
                               users-by-username-query=
                                       "select USEREMAIL,PASSWORD, ENABLED from user where USEREMAIL=?"
                               authorities-by-username-query=
                                       "select USEREMAIL,ROLE from user where USEREMAIL=?"/>
        </authentication-provider>
    </authentication-manager>


    <!--
        <http auto-config="true" >
            <intercept-url pattern="/" access="permitAll" />
            <intercept-url pattern="/home" access="permitAll" />
            <intercept-url pattern="/admin**" access="hasRole('ADMIN')" />
            <intercept-url pattern="/dba**" access="hasRole('ADMIN') and hasRole('DBA')" />
            <form-login  authentication-failure-url="/Access_Denied" />
        </http>

        <authentication-manager >
            <authentication-provider>
                <user-service>
                    <user name="bill"  password="abc123"  authorities="ROLE_USER" />
                    <user name="admin" password="root123" authorities="ROLE_ADMIN" />
                    <user name="dba"   password="root123" authorities="ROLE_ADMIN,ROLE_DBA" />
                </user-service>
            </authentication-provider>
        </authentication-manager>
    -->

</beans:beans>